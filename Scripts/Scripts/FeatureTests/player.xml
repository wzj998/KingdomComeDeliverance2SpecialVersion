<FeatureTester xmlns="http://www.warhorsestudios.cz/tests">
	<Settings>
    <!--change-->
	</Settings>
	
  <!--  edited version 20170308 -->
	<Tests setName="utils">
		<FeatureTest name="UtilSprintForASecond">
			<OverrideButtonInput_Press inputName="moveforward" />
			<OverrideButtonInput_Press inputName="sprint" />
			<Wait duration="1" />
			<OverrideButtonInput_Release inputName="sprint" />
			<OverrideButtonInput_Release inputName="moveforward" />
		</FeatureTest>

		<FeatureTest name="UtilPushUseButton">
			<OverrideButtonInput_Press inputName="xi_use" />
			<WaitSingleFrame />
			<OverrideButtonInput_Release inputName="xi_use" />
			<Wait duration="0.5"/>
		</FeatureTest>

		<FeatureTest name="UtilResetPlayerToStar">
			<DoConsoleCommand command="playerGoto 1020, 1040, 0.1"/>
			<WaitSingleFrame/>
			<Wait duration="0.5" />
		</FeatureTest>

		<FeatureTest name="UtilResetPlayerToTestTrackStart">
			<DoConsoleCommand command="playerGoto 1040, 1040, 0"/>
			<WaitSingleFrame/>
			<Wait duration="0.5" />
		</FeatureTest>

		<FeatureTest name="UtilHighJump">
			<Wait duration="1.0" />			
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_PressJumpWhileCrouchedToStandUp" response="restartSubroutine"/>
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_PressJumpWhileNotAllowedToJump" response="restartSubroutine"/>
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_PressJumpInputIgnored" response="restartSubroutine"/>
			<SetResponseToHittingCCCPoint checkpointName="ActorMovement_LocalPlayerLanded" response="expectedNext"/>
			<SetResponseToHittingCCCPoint checkpointName="ActorMovement_LocalPlayerNormalJump" response="expectedNext"/>
			<SetResponseToHittingCCCPoint checkpointName="LProximityTriggerEntered" response="expectedNext"/>
			<OverrideButtonInput_Press inputName="moveforward" />
			<WaitSingleFrame/>
			<OverrideButtonInput_Press inputName="jump" />
			<WaitSingleFrame />
			<OverrideButtonInput_Release inputName="jump" />
			<WaitUntilHitAllExpectedCCCPoints timeout="3.0"/>
			<OverrideButtonInput_Release inputName="moveforward" />
		</FeatureTest>

		<FeatureTest name="UtilJump">
			<OverrideButtonInput_Press inputName="jump" />
			<WaitSingleFrame />
			<OverrideButtonInput_Release inputName="jump" />
		</FeatureTest>
		
		<FeatureTest name="UtilGoUntilTrigger5SecTimeout">
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="LProximityTriggerEntered" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="5.0"/>
			<OverrideButtonInput_Release inputName="moveforward" />
			<Fail/>			
		</FeatureTest>
		
 		<FeatureTest name="UtilGoNoTrigger5SecTimeout">
			<SetResponseToHittingCCCPoint response="failTest" checkpointName="LProximityTriggerEntered" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="5.0"/>
			<OverrideButtonInput_Release inputName="moveforward" />
		</FeatureTest>

		<FeatureTest name="UtilGoUntilTrigger8SecTimeout">
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="LProximityTriggerEntered" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="8.0"/>
			<OverrideButtonInput_Release inputName="moveforward" />
			<Fail/>			
		</FeatureTest>

		<FeatureTest name="UtilGoNoTrigger5SecTimeout">
			<SetResponseToHittingCCCPoint response="failTest" checkpointName="LProximityTriggerEntered" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="8.0"/>
			<OverrideButtonInput_Release inputName="moveforward" />
		</FeatureTest>

		<FeatureTest name="UtilGoUntilTrigger15SecTimeout">
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="LProximityTriggerEntered" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="15.0"/>
			<OverrideButtonInput_Release inputName="moveforward" />
			<Fail/>			
		</FeatureTest>

 		<FeatureTest name="UtilGoNoTrigger15SecTimeout">
			<SetResponseToHittingCCCPoint response="failTest" checkpointName="LProximityTriggerEntered" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="15.0"/>
			<OverrideButtonInput_Release inputName="moveforward" />
		</FeatureTest>

		
		<FeatureTest name="UtilFollow" enabled="true" owners="tomas.grunwald">
			<SetLocalPlayerLookAtEntity duration="3.0" entityName="Reisefuhrer" bone="BONEID_HEAD" />
			
			<OverrideAnalogInput inputName="xi_movey" value="0.10"/>
			<Wait duration="3.0" />
			<OverrideAnalogInput inputName="xi_movey" value="0.0"/>
			<!--clear look at-->
			<SetLocalPlayerLookAtEntity duration="0.1" entityName="dummy" bone="" />
			<Wait duration="0.1" />
		</FeatureTest>

    <FeatureTest name='WaitPlayerStandUp' enabled='true' owners='tomas.grunwald'>
     <!-- 20161207 zmeneno z 5 na 8. Obcas kuli pomalemu stavani failovalo strileni z luku LS-->
      <Wait duration='8'/>
    </FeatureTest>

    <FeatureTest name='UtilQuitInventory' enabled='true' owners='tomas.grunwald'>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_back"/>
      <Wait duration="2"/>
    </FeatureTest>
    
	</Tests>
  
	<Tests setName="Basics">
		<FeatureTest name="LocalPlayerExistsAndRemoveHorse" description="Local player should exist" require="localPlayerExists" enabled="true" maxTime="30" owners="tomas.grunwald">
			<DoConsoleCommand command="g_autoReviveTime 7.f" />
			<DoConsoleCommand command="g_timeLimit 0" />
			<DoConsoleCommand command="g_scoreLimit 0" />
			<DoConsoleCommand command="#ActionMapManager.EnableActionMap('player', false);" />
      
			<DoConsoleCommand command="#local h = System.GetEntityByName('Horse1'); if h then h:SetWorldPos({x=0,y=0,z=0}) end;"/>

			<DoConsoleCommand command="#GameCodeCoverage.Reset();"/>
      <RunFeatureTest testName="UtilQuitInventory"/>
		</FeatureTest>

		<FeatureTest name="ProximityTrigger" description="Test, if proximity triggers reacts on player" enabled="true" owners="tomas.grunwald" prerequisite="LocalPlayerExistsAndRemoveHorse">
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="LProximityTriggerEntered" />
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="LProximityTriggerLeft" />
			<DoConsoleCommand command="playerGoto 1000, 1000, 0.2"/>
			<WaitSingleFrame/>
			<DoConsoleCommand command="playerGoto 1002, 1000, 0.2"/>
			<WaitSingleFrame/>
			<WaitUntilHitAllExpectedCCCPoints timeout="1.0"/>			
		</FeatureTest>
		
		<FeatureTest name="MoveForward" description="Player moves forward" enabled="true" owners="tomas.grunwald" prerequisite="ProximityTrigger">
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="TriggerFront" />
			<RunFeatureTest testName="UtilResetPlayerToStar" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="3.0" />
			<OverrideButtonInput_Release inputName="moveforward" />
			<Fail/>
		</FeatureTest>
		
		<FeatureTest name="MoveBackward" description="Player moves backward" enabled="true" owners="tomas.grunwald" prerequisite="ProximityTrigger">
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="TriggerBack" />
			<RunFeatureTest testName="UtilResetPlayerToStar" />
			<OverrideButtonInput_Press inputName="moveback" />
			<Wait duration="3.0" />
			<OverrideButtonInput_Release inputName="moveback" />
			<Fail/>
		</FeatureTest>

		<FeatureTest name="StrafeLeft" description="Player strafes left" enabled="true" owners="tomas.grunwald" prerequisite="ProximityTrigger">
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="TriggerLeft" />
			<RunFeatureTest testName="UtilResetPlayerToStar" />
			<OverrideButtonInput_Press inputName="moveleft" />
			<Wait duration="3.0" />
			<OverrideButtonInput_Release inputName="moveleft" />
			<Fail/>
		</FeatureTest>

		<FeatureTest name="StrafeRight" description="Player strafes right" enabled="true" owners="tomas.grunwald" prerequisite="ProximityTrigger">
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="TriggerRight" />
			<RunFeatureTest testName="UtilResetPlayerToStar" />
			<OverrideButtonInput_Press inputName="moveright" />
			<Wait duration="3.0" />
			<OverrideButtonInput_Release inputName="moveright" />
			<Fail/>
		</FeatureTest>

		<FeatureTest name="Jump" description="Player jumps" enabled="0" owners="tomas.grunwald" prerequisite="ProximityTrigger">
			<RunFeatureTest testName="UtilResetPlayerToStar"/>			
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_PressJumpWhileCrouchedToStandUp" response="restartSubroutine"/>
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_PressJumpWhileNotAllowedToJump" response="restartSubroutine"/>
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_PressJumpInputIgnored" response="restartSubroutine"/>
			<SetResponseToHittingCCCPoint checkpointName="ActorMovement_LocalPlayerLanded" response="expectedNext"/>
			<SetResponseToHittingCCCPoint checkpointName="ActorMovement_LocalPlayerNormalJump" response="expectedNext"/>
			<RunFeatureTest testName="UtilJump"/>
			<WaitUntilHitAllExpectedCCCPoints timeout="2.0"/>
		</FeatureTest>

		<FeatureTest name="Sprint" description="Player tries to sprint" enabled="true" owners="tomas.grunwald" prerequisite="MoveForward">
			<RunFeatureTest testName="UtilResetPlayerToStar"/>
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_SprintOn" response="expectedNext"/>
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_SprintOff" response="expectedNext"/>
			<SetResponseToHittingCCCPoint checkpointName="LProximityTriggerEntered" response="expectedNext"/>
			<SetResponseToHittingCCCPoint checkpointName="PlayerMovement_SprintRequestIgnored" response="failTest"/>
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="0.5" />
			<OverrideButtonInput_Press inputName="sprint" />
			<Wait duration="1.0" />
			<OverrideButtonInput_Release inputName="sprint" />
			<WaitSingleFrame />
			<OverrideButtonInput_Release inputName="moveforward" />
			<WaitUntilHitAllExpectedCCCPoints timeout="0.5"/>
		</FeatureTest>

		<FeatureTest name="LookAtTriggerAndMoveThere" description="Player turns around and goes to the trigger" enabled="true" owners="tomas.grunwald" prerequisite="MoveForward">
			<!--beam player after the trigger-->
			<DoConsoleCommand command="playerGoto 1020, 1050, 0"/>
			<Wait duration="1.0" />
			<!--turn around using lookat-->
			<SetLocalPlayerLookAtEntity duration="4.0" entityName="FrontTrigger" bone="" />
			<Wait duration="4.0" />
			<SetLocalPlayerLookAtEntity duration="0.1" entityName="dummy" bone="" /> <!--clear look at-->
			<Wait duration="0.1" />
			<!--goto trigger-->
			<SetResponseToHittingCCCPoint response="completeTest" checkpointName="LProximityTriggerEntered" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="3.0" />
			<OverrideButtonInput_Release inputName="moveforward" />
			<Fail/>
		</FeatureTest>
    
    <FeatureTest name="justUnlockPlayerControl" description="simple function to unlock player contorl" enabled="true">
      <DoConsoleCommand command="#ActionMapManager.EnableActionMap('player', true);" />
    </FeatureTest>
    
	</Tests>
	
	<Tests setName="Obstacles">

    <FeatureTest name="ClimbLadderStart" description="Hrac se pokusi splhat po zebriku" enabled="false" owners="tomas.grunwald" >
      <!-- <SetResponseToHittingCCCPoint response="expectedNext" checkpointName="Human_LadderEnter" /> -->
      <DoConsoleCommand command="playerGoto 1032, 1020.5, 0"/>
      <SetLocalPlayerLookAtEntity duration="4.0" entityName="Ladder6" bone="" />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame/>
      <OverrideButtonInput_Release inputName="use"/>
      <WaitUntilHitAllExpectedCCCPoints timeout="3"/>
    </FeatureTest>

    <FeatureTest name="ClimbLadder" description="Hrac se pokusi splhat po zebriku" enabled="false" owners="tomas.grunwald" prerequisite="ClimbLadderStart" >

			<SetResponseToHittingCCCPoint checkpointName="Zebrik" response="completeTest"/>
			<Wait duration="0.2"/>
			<OverrideAnalogInput inputName="moveforward" value="1"/>
			<WaitUntilHitAllExpectedCCCPoints timeout="10"/>
			<OverrideAnalogInput inputName="moveforward" value="0"/>
		</FeatureTest>
		

		<!--ability of player going upstairs, max slope shoud be 50-->
		<FeatureTest name="Stairs30" description="Player should be able to go upstairs, slope 30 degrees" enabled="true" owners="tomas.grunwald"  prerequisite="MoveForward"  >
  
			<DoConsoleCommand command="playerGoto 1099.5, 1031.5, 0"/>
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

		<FeatureTest name="Stairs40" description="Player should be able to go upstairs, slope 40 degrees" enabled="true" owners="tomas.grunwald" prerequisite="Stairs30">
			<DoConsoleCommand command="playerGoto 1101, 1031.5, 0"/>
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

		<!-- Po dohode s Michalem B. a Petrem Samkem - tohle player nema byt schopen vyjit. !-->

		<FeatureTest name="Stairs45" description="Player should be able to go upstairs, slope 45 degrees" enabled="false" owners="tomas.grunwald" prerequisite="MoveForward">
			<DoConsoleCommand command="playerGoto 1102.5, 1031.5, 0"/>
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

		<FeatureTest name="Stairs50" description="Player should be able to go upstairs, slope 50 degrees" enabled="false" owners="tomas.grunwald" prerequisite="MoveForward">
			<DoConsoleCommand command="playerGoto 1104, 1031.5, 0"/>
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

    <!-- -->	

		<!--door passability tests-->
		<FeatureTest name="Door140" description="Player should be able to go through the door. 140cm" enabled="true" owners="tomas.grunwald" prerequisite="MoveForward">
			<DoConsoleCommand command="playerGoto 1095, 1031.5, 0"/>
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

		<FeatureTest name="Door120" description="Player should be able to go through the door. 120cm - this is minimal size of door." enabled="true" owners="tomas.grunwald" prerequisite="Door140">
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

		<FeatureTest name="Door100" description="Player should be able to go through the door. 100cm - character capsule is 70cm, so it should still fit" enabled="true" owners="tomas.grunwald" prerequisite="Door120">
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

		<FeatureTest name="Door80" description="Player should be able to go through the door. 80cm - character capsule is 70cm, so it should still fit" enabled="true" owners="tomas.grunwald" prerequisite="Door100">
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

		<FeatureTest name="Door70" description="Player should be able to go through the door. 70cm - character capsule is 70cm, so it should still fit" enabled="false" owners="tomas.grunwald" prerequisite="Door80">
			<RunFeatureTest testName="UtilGoUntilTrigger5SecTimeout" />
		</FeatureTest>

    

    <FeatureTest name="Slope40" description="Player should go up the hill. Slope 40 degrees" enabled="true" owners="LS" prerequisite="MoveForward">
      <DoConsoleCommand command="playerGoto 1088, 1000, 0"/>
      <RunFeatureTest testName="UtilGoUntilTrigger15SecTimeout" />
    </FeatureTest>

    <FeatureTest name="Slope47" description="Player should go up the hill. Slope 47 degrees" enabled="true" owners="LS" prerequisite="Slope40">
      <DoConsoleCommand command="playerGoto 1090, 1000, 0"/>
      <RunFeatureTest testName="UtilGoUntilTrigger15SecTimeout" />
    </FeatureTest>

    <FeatureTest name="Slope48" description="Player should go up the hill. Slope 48.99 degrees" enabled="true" owners="LS" prerequisite="Slope47">
      <DoConsoleCommand command="playerGoto 1092, 1000, 0"/>
      <RunFeatureTest testName="UtilGoUntilTrigger15SecTimeout" />
    </FeatureTest>

    <FeatureTest name="Slope49" description="Player should NOT go up the hill. Slope 49 degrees" enabled="true" owners="LS" prerequisite="Slope48">
      <DoConsoleCommand command="playerGoto 1094, 1000, 0"/>
      <RunFeatureTest testName="UtilGoNoTrigger15SecTimeout" />
    </FeatureTest>
    
    <FeatureTest name="Slope50" description="Player should NOT go up the hill. Slope 50 degrees" enabled="true" owners="LS" prerequisite="Slope49">
      <DoConsoleCommand command="playerGoto 1096, 1000, 0"/>
      <RunFeatureTest testName="UtilGoNoTrigger15SecTimeout" />
    </FeatureTest>

		
		<!--set of obstacles, should be overcomed by the player-->
		<FeatureTest name="RunThruObstacles" description="Player runs thru track with obstacles, hurdles, jumps etc.." enabled="false" owners="tomas.grunwald" >
			<!--block the input-->
			<DoConsoleCommand command="#ActionMapManager.EnableActionMap('player', false);" />
			<DoConsoleCommand command="playerGoto 1040, 1040, 0"/>

			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="LProximityTriggerEntered" />
			
			<!--jump the hurdle-->
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackHurdle" />
			<OverrideButtonInput_Press inputName="moveforward" />
			<Wait duration="0.5" />
			<OverrideButtonInput_Press inputName="sprint" />
			<Wait duration="0.15" />
			<RunFeatureTest testName="UtilJump"/>
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackTurnBegin" />
			<Wait duration="0.9" />
			<CheckNumCCCPointHits checkpointName="TrackHurdle" expectedNumHits="1"/>
			
			<!--run thru the curve-->
		 
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackTurnEnd" />
			<OverrideAnalogInput inputName="xi_rotateyaw" value="1.102"/>
			<Wait duration="0.5" />
			<OverrideAnalogInput inputName="xi_rotateyaw" value="0.0"/>
			<Wait duration="0.15" />
			<CheckNumCCCPointHits checkpointName="TrackTurnBegin" expectedNumHits="1"/>
			<CheckNumCCCPointHits checkpointName="TrackTurnEnd" expectedNumHits="1"/>
			
			<!--jump the platform-->
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackPlatformJump" />
			<RunFeatureTest testName="UtilJump"/>
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackPlatformLeapStart" />
			<Wait duration="0.9" />
			<CheckNumCCCPointHits checkpointName="TrackPlatformJump" expectedNumHits="1"/>
			
			<!--leap over the gap-->
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackPlatformLeapEnd" />
			<RunFeatureTest testName="UtilJump"/>
			<WaitUntilHitAllExpectedCCCPoints timeout="1.0"/>
			<DoConsoleCommand command="playerGoto 1056.5, 1052.5, 3, 0, 0, -90"/>
			
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackChicaneStart" />
			<WaitUntilHitAllExpectedCCCPoints timeout="1.5"/>
			
			<!--strafe to the left gate-->
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackChicaneLeft" />
			<Wait duration="0.4"/>
			<OverrideButtonInput_Press inputName="moveleft" />
			<WaitUntilHitAllExpectedCCCPoints timeout="1.5"/>
			<!--<Wait duration="1.0" />-->
			<OverrideButtonInput_Release inputName="moveleft" />
			<WaitSingleFrame/>
			<CheckNumCCCPointHits checkpointName="TrackChicaneLeft" expectedNumHits="1"/>

			<!--strafe to the righ gate-->
			<SetResponseToHittingCCCPoint response="expectedNext" checkpointName="TrackChicaneRight" />
			<OverrideButtonInput_Press inputName="moveright" />
			<Wait duration="0.8" />
			<OverrideButtonInput_Release inputName="moveright" />

			<!--just run to the finish-->
			<Wait duration="1.5" />
			<CheckNumCCCPointHits checkpointName="TrackChicaneRight" expectedNumHits="1"/>
			
			<!--the end-->
			<OverrideAnalogInput inputName="xi_rotateyaw" value="0.0"/>
			<WaitSingleFrame />
			<OverrideButtonInput_Release inputName="sprint" />
			<WaitSingleFrame />
			<OverrideButtonInput_Release inputName="moveforward" />
			<DoConsoleCommand command="#ActionMapManager.EnableActionMap('player', true);" />
			
			<CheckNumCCCPointHits checkpointName="LProximityTriggerEntered" expectedNumHits="9"/>
			
		</FeatureTest>
		
	</Tests>

  <Tests setName="RPG">
    <FeatureTest name="no_herbs" enabled="true" owners="tomas.grunwald">
      <RegisterLogAsCCCPoint message="Kopriv0"/>
      <SetResponseToHittingCCCPoint checkpointName="Kopriv0" response="completeTest"/>
      <DoConsoleCommand command='#DebugUtils.Log("Kopriv" .. player.inventory:GetCountOfClass("5e9b4fa1-aafa-4352-b5d6-58df2c263caa"))'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
      <Fail/>
    </FeatureTest>
    <FeatureTest name="herb_picking" enabled="true" owners="tomas.grunwald">
      <!-- napozicovat hrace pred trs kopriv -->
      <DoConsoleCommand command="playerGoto 1022, 1086, 0"/>
      <!-- nechat ho, at kouka na koprivy -->
      <SetLocalPlayerLookAtEntity entityName="TagPointHerbs01" duration="5" bone=""/>
      <!-- Chvilku pockat, nez se na ne opravdu podiva -->
      <Wait duration="5"/>
      <!-- stisk tlacitka sbirani -->
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <!-- Ted dlouha animace, jak hrac sbira -->
      <Wait duration="10"/>
      <!-- pocet kopriv v inventory -->
      <RegisterLogAsCCCPoint message="Kopriv1"/>
      <SetResponseToHittingCCCPoint checkpointName="Kopriv1" response="completeTest"/>
      <DoConsoleCommand command='#DebugUtils.Log("Kopriv" .. player.inventory:GetCountOfClass("5e9b4fa1-aafa-4352-b5d6-58df2c263caa"))'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
      <Fail/>
    </FeatureTest>
    <FeatureTest name="herbs_picking" enabled="true" owners="tomas.grunwald">
      <!-- napozicovat hrace pred trs kopriv -->
      <DoConsoleCommand command="playerGoto 1018, 1086, 0"/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <DoConsoleCommand command="#player.soul:SetSkillLevelDebug('survival', 2)"/>
      <!-- nechat ho, at kouka na koprivy -->
      <SetLocalPlayerLookAtEntity entityName="TagPointHerbs02" duration="5" bone=""/>
      <!-- Chvilku pockat, nez se na ne opravdu podiva -->
      <Wait duration="5"/>
      <!-- stisk tlacitka sbirani -->
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <!-- Ted dlouha animace, jak hrac sbira -->
      <Wait duration="10"/>
      <!-- pocet kopriv v inventory -->
      <DoConsoleCommand command=""/>
      <RegisterLogAsCCCPoint message="Kopriv21"/>
      <SetResponseToHittingCCCPoint checkpointName="Kopriv21" response="completeTest"/>
      <DoConsoleCommand command='#DebugUtils.Log("Kopriv" .. player.inventory:GetCountOfClass("5e9b4fa1-aafa-4352-b5d6-58df2c263caa"))'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
      <Fail/>
    </FeatureTest>

    <FeatureTest name="damagePlayer" enabled="1" owners="tomas.grunwald">
      <SetResponseToHittingCCCPoint checkpointName='ActorState_LocalPlayerHealthReduced' response="expectedNext"/>
      <!-- udelit damage -->
      <DoConsoleCommand command="#player.soul:DealDamage(50, 50)"/>
      <!-- Zkontrolovat, ze dostal damage -->
      <RegisterLogAsCCCPoint message="Health50"/>
      <SetResponseToHittingCCCPoint checkpointName="Health50" response="expectedNext"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#DebugUtils.Log("Health" .. player.soul:GetState("health"))'/>
      <!-- Pockam az player vstane -->
      <RunFeatureTest testName="WaitPlayerStandUp" />
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
    </FeatureTest>


    <!-- S timhle jsou jenom problemy. Navic je momentalne sleep vypnuty. Budu radsi spoustet rucne!-->

    <FeatureTest name="use_bed" enabled="0" owners="tomas.grunwald" prerequisite="damagePlayer">
      <!-- napozicovat -->
      <DoConsoleCommand command="playerGoto 1013.94, 1069.89, 0"/>
      <SetLocalPlayerLookAtEntity duration="5.0" entityName="TagPointBed" bone="" />
      <Wait duration="5"/>
      <!-- Sednout -->
      <OverrideButtonInput_Press inputName='use'/>
      <WaitSingleFrame/>
      <OverrideButtonInput_Release inputName='use'/>

      <!-- Pockat az si sedne -->
      <Wait duration="5"/>
      <!-- lehnout -->
      <OverrideButtonInput_Press inputName='sitting_sleep'/>
      <WaitSingleFrame/>
      <OverrideButtonInput_Release inputName='sitting_sleep'/>

      <!-- pockat nez si lehne -->
      <SetResponseToHittingCCCPoint checkpointName='Player_SleepDialog' response='expectedNext' />
      <WaitUntilHitAllExpectedCCCPoints timeout='15'/>
      <Wait duration='5' />
    </FeatureTest>

      
    <FeatureTest name="sleep" enabled="0" owners="tomas.grunwald" prerequisite="use_bed"> 
      <!-- navolit cas -->
      <OverrideButtonInput_Press inputName='ui_down'/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName ='ui_down'/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName='ui_accept'/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName='ui_accept'/>
      <Wait duration="1200"/>
      <!-- mela by chodit zprava o tom, ze se player uzdravuje -->
     <!-- <SetResponseToHittingCCCPoint checkpointName='ActorState_LocalPlayerHealthRegenerated' response="expectedNext"/>-->
  
    </FeatureTest>
    
    <FeatureTest name="wakeUp" enabled="0" owners="tomas.grunwald" prerequisite="sleep">
      <Wait duration="30"/>
      <DoConsoleCommand command='#DebugUtils.Log("wait done")'/>
      <WaitSingleFrame/>
      <OverrideButtonInput_Press inputName="sitting_end"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="sitting_end"/>
      <WaitSingleFrame />
      <!--Pockat nez player vstane -->
      <!--<SetResponseToHittingCCCPoint checkpointName='Player_InteractiveActionEnd' response="expectedNext"/>-->
      <!--<WaitUntilHitAllExpectedCCCPoints timeout='1000'/>-->
    
    
      <Wait duration="10"/>
    </FeatureTest>

    <FeatureTest name="forceStandUp" enabled="0" description="failsafe for previous test" owners="LS">
      <Wait duration="5"/>
      <WaitSingleFrame/>
      <OverrideButtonInput_Press inputName="sitting_end"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="sitting_end"/>
      <WaitSingleFrame />
      <Wait duration="10"/>
    </FeatureTest>
    
    <FeatureTest name="healthRegenerated" enabled="0" owners="tomas.grunwald" prerequisite="sleep" >
      <RegisterLogAsCCCPoint message="Health100"/>
      <SetResponseToHittingCCCPoint checkpointName="Health100" response="expectedNext"/>
      <DoConsoleCommand command='#DebugUtils.Log("Health" .. player.soul:GetState("health"))'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
      <!-- zkontrolovat, ze se zdravi zlepsilo -->
      <!-- vstat z postele -->
      <!-- pockat -->
      <Wait duration='5'/>
    </FeatureTest>

    <FeatureTest name="hunger" description="Zbastim jablko z inventare" enabled="1" owners="Jarda">
      <DoConsoleCommand command='#DebugUtils.Log("hunger init")'/>
      <RegisterLogAsCCCPoint message="Hunger97"/>
      <RegisterLogAsCCCPoint message="Hunger100"/>
      <SetResponseToHittingCCCPoint checkpointName="Hunger97" response="expectedNext"/>
      <SetResponseToHittingCCCPoint checkpointName="Hunger100" response="expectedNext"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <!-- 20170221 zmeny ID jablka. Duplicitni jablka byla smazana z DB a FT failoval, protoze nemohl jablko najit-->
      <DoConsoleCommand command="#local a = ItemManager.CreateItem('2264f217-590e-4c0f-a4c6-f50c6532b9f6', 1, 20); g_localActor.inventory:AddItem(a);"/>
      <DoConsoleCommand command="#local a = ItemManager.CreateItem('2264f217-590e-4c0f-a4c6-f50c6532b9f6', 1, 20); g_localActor.inventory:AddItem(a);"/>
      <DoConsoleCommand command="#local a = ItemManager.CreateItem('2264f217-590e-4c0f-a4c6-f50c6532b9f6', 1, 20); g_localActor.inventory:AddItem(a);"/>
      <DoConsoleCommand command="#player.soul:SetState('hunger',97)"/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#DebugUtils.Log("Hunger" .. player.soul:GetState("hunger"))'/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_toggle_inventory"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_toggle_inventory"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_accept"/>
      <Wait duration="4"/>
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_accept"/>
      <Wait duration="4"/>
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_accept"/>
      <Wait duration="4"/>
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <Wait duration="2"/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.soul:GetState("hunger"); DebugUtils.Log("hunger - ocekavam: 99-101; mam: " .. a); if((a &gt; 99) and (a &lt;=101 )) then DebugUtils.Log("Hunger100") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
      <RunFeatureTest testName='UtilQuitInventory'/>
    </FeatureTest>

    <!-- LUKOSTRELECKY TEST - hrac si equipne luk a sipy, natoci se na terc (zde by mela byt odstranena chyba s otacenim mimo terc viz. text nize) a vystreli 2x do terce, 1x mine, posledni sip zustane v inventari-->
    <FeatureTest name='equipBow' enabled='1' description='Hrac si nacheatuje luk, sipy a equipne' owners='Jarda'>
      <RunFeatureTest testName='UtilQuitInventory'/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <DoConsoleCommand command="#player.soul:SetState('stamina',100)"/>
      <DoConsoleCommand command="#player.soul:SetState('health',100)"/>
      <DoConsoleCommand command="#local a = ItemManager.CreateItem('d5e6764d-18ba-44cb-8dd0-6640a17785a8', 1, 4); g_localActor.inventory:AddItem(a); local a = ItemManager.CreateItem('03589a69-d3f4-403a-a389-ca021e7c8f40', 1, 1); g_localActor.inventory:AddItem(a);"/>
      <DoConsoleCommand command="#player.soul:AdvanceToSkillLevel('marksmanship', 30)"/>
      <DoConsoleCommand command="#player.soul:AdvanceToStatLevel('str',20)"/>
      <!-- pridano zvedani agility, aby nefailovalo strileni z luku-->
      <DoConsoleCommand command="#player.soul:AdvanceToStatLevel('agi',20)"/>
      <OverrideButtonInput_Press inputName="ui_toggle_inventory"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_toggle_inventory"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName='ui_down'/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName ='ui_down'/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_back"/>
      <WaitSingleFrame />
      <DoConsoleCommand command="#Variables.SetGlobal('archeryTest',1)"/>  
      <WaitSingleFrame />
      <DoConsoleCommand command="playerGoto 1030, 995, 0"/>
      <WaitSingleFrame />
      <Wait duration="5"/>
      <WaitSingleFrame />
      <DoConsoleCommand command="#Variables.SetGlobal('archeryTest',0)"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="weapon_set2"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="weapon_set2"/>
      <WaitSingleFrame />
      <Wait duration="5"/>
      <!--Zde jsem prohodil LookingEntity pod weapon_set2 (tedy vytahovani luku). Kvuli vytahovani se obcas natocil mimo mirenou oblast, ted se srovnava az po vytazeni luku-->
      <SetLocalPlayerLookAtEntity entityName="ShootingTarget2" bone="Hips" duration="1"/>
      <Wait duration="1"/>
      <WaitSingleFrame />
    </FeatureTest>

    <FeatureTest name='shootToTarget1' enabled='1' description='Hrac vystreli 1. sip do terce' owners='Jarda'>
      <SetResponseToHittingCCCPoint checkpointName='targetHit_player_OK' response='expectedNext'/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="attack1_mouse"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="attack1_mouse"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Release inputName="attack1_mouse"/>
      <WaitSingleFrame />
      <WaitUntilHitAllExpectedCCCPoints timeout='5'/>
    </FeatureTest>

    <FeatureTest name='shootToTarget2' enabled='1' description='Hrac vystreli 2. sip do terce' owners='Jarda'>
      <SetResponseToHittingCCCPoint checkpointName='targetHit_player_OK' response='expectedNext'/>
      <Wait duration="4"/>
      <OverrideButtonInput_Press inputName="attack1_mouse"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="attack1_mouse"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Release inputName="attack1_mouse"/>
      <WaitSingleFrame />
      <WaitUntilHitAllExpectedCCCPoints timeout='5'/>
    </FeatureTest>

    <FeatureTest name='noFullStretchBow' enabled='1' description='Hrac vystreli 3. sip, ale malo a spadne pred terc' owners='Jarda'>
      <SetResponseToHittingCCCPoint checkpointName='arrowFall_player_OK' response='expectedNext'/>
      <Wait duration="4"/>
      <OverrideButtonInput_Press inputName="attack1_mouse"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="attack1_mouse"/>
      <Wait duration="0.5"/>
      <OverrideButtonInput_Release inputName="attack1_mouse"/>
      <WaitSingleFrame />
      <WaitUntilHitAllExpectedCCCPoints timeout='7'/>
    </FeatureTest>

    <FeatureTest name='lastArrowInInventory' enabled='1' description='Zkontroluje se, ze je v inventari posledni sip' owners='Jarda'>
      <RegisterLogAsCCCPoint message="Sipu 1"/>
      <SetResponseToHittingCCCPoint checkpointName="Sipu 1" response="expectedNext"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#DebugUtils.Log("Sipu " .. player.inventory:GetCountOfClass("d5e6764d-18ba-44cb-8dd0-6640a17785a8"))'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
    </FeatureTest>
    <!-- KONEC LUKOSTRELECKEHO TESTU -->

    <!--BANDAGE TEST ZACATEK-->
    <FeatureTest name="takeDamage" enabled="true" description="Hrac se zrani" owners="Jarda">
      <RegisterLogAsCCCPoint message="Krvaceni 1 z 4 ok"/>
      <SetResponseToHittingCCCPoint checkpointName="Krvaceni 1 z 4 ok" response="expectedNext"/>
      <Wait duration="1"/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <DoConsoleCommand command="#player.soul:SetState('stamina',100)"/>
      <DoConsoleCommand command="#player.soul:SetState('health',100)"/>s
      <DoConsoleCommand command="#player.soul:DealDamage(50,50,0,true,'head')"/> <!-- TRUE v deal damage znamena ze nebudu reagovat na hit reakci --> 
      <DoConsoleCommand command="#player.soul:SetState('stamina',100)"/>
      <DoConsoleCommand command="#player.soul:SetState('health',100)"/>
      <DoConsoleCommand command="#player.soul:DealDamage(50,50,0,true,'torso')"/>
      <DoConsoleCommand command="#player.soul:SetState('health',100)"/>
      <DoConsoleCommand command="#player.soul:SetState('stamina',100)"/>
      <!--UNLOCK FIRST AID SKILL TO USE BANDAGE-->
      <DoConsoleCommand command="wh_rpg_unlockAll 1"/>
     
      <WaitSingleFrame />
      <DoConsoleCommand command="#local h = ItemManager.CreateItem('9fa3000e-3807-48a8-bed8-81427f0bda55', 1, 50); g_localActor.inventory:AddItem(h);"/>
      <WaitSingleFrame />
      <!-- Wait zde musi byt, proto v inventari plyne cas 1000x pomaleji a behem bandazovani neztratim v inventari zadny health... proto na zacatku testu, kdyz zacnu krvacet si
      musim pockat, jestli se krvaceni projevi na mem zdravi --> 
      <Wait duration="20"/>
      
      <DoConsoleCommand command='#a = (player.soul:GetDerivedStat("ble")); DebugUtils.Log("Krvaceni - ocekavam: 2; mam: " .. a); if((a &gt; 1.9) and (a &lt;=2 )) then DebugUtils.Log("Krvaceni 1 z 4 ok") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>
    </FeatureTest>

    <FeatureTest name="bandageSecondToHalf" enabled="true" description="Osetri si nejprve druhou cast, kterou mu nabiidne inventar" owners="Jarda">
      <DoConsoleCommand command='#Dump("testlog")'/>
      <RegisterLogAsCCCPoint message="Krvaceni 2 z 4 ok"/>
      <SetResponseToHittingCCCPoint checkpointName="Krvaceni 2 z 4 ok" response="expectedNext"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_toggle_inventory"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_toggle_inventory"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_left"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_left"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName='ui_back'/>
      <WaitSingleFrame/>
      <OverrideButtonInput_Release inputName='ui_back'/>
      <WaitSingleFrame/>
      <Wait duration="1"/>
      <DoConsoleCommand command='#a = (player.soul:GetDerivedStat("ble")); DebugUtils.Log("Krvaceni - ocekavam: 1.4-1.5 ; mam: " .. a); if((a &gt; 1.4) and (a &lt;=1.5 )) then DebugUtils.Log("Krvaceni 2 z 4 ok") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>
    </FeatureTest>

      
    <FeatureTest name="bandageFirstToHalf" enabled="true" description="Osetri si prvni cast, kterou mu nabidne inventar" owners="Jarda">
      <RegisterLogAsCCCPoint message="Krvaceni 3 z 4 ok"/>
      <SetResponseToHittingCCCPoint checkpointName="Krvaceni 3 z 4 ok" response="expectedNext"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_toggle_inventory"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_toggle_inventory"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName='ui_back'/>
      <WaitSingleFrame/>
      <OverrideButtonInput_Release inputName='ui_back'/>
      <WaitSingleFrame/>
      <Wait duration="1"/>
      <DoConsoleCommand command='#a = (player.soul:GetDerivedStat("ble")); DebugUtils.Log("Krvaceni - ocekavam: 1; mam: " .. a); if((a &gt; 0.9) and (a &lt;=1 )) then DebugUtils.Log("Krvaceni 3 z 4 ok") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>
    </FeatureTest>

    <FeatureTest name="bandageRestOfBleedingParts" enabled="true" description="Vyleci zbyvajici casti, nejprve druhou a pote tu prvni" owners="Jarda">
      <RegisterLogAsCCCPoint message="Krvaceni 4 z 4 ok"/>
      <SetResponseToHittingCCCPoint checkpointName="Krvaceni 4 z 4 ok" response="expectedNext"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_toggle_inventory"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_toggle_inventory"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_back"/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = (player.soul:GetDerivedStat("ble")); DebugUtils.Log("Krvaceni - ocekavam: 0; mam: " .. a); if(a == 0) then DebugUtils.Log("Krvaceni 4 z 4 ok") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>
    </FeatureTest>

    <FeatureTest name="lostHealthAfterBleeding" enabled="true" description="Kontrola, jestli jsem ztratil nejake zdravi behem krvaceni" owners="Jarda">
      <RegisterLogAsCCCPoint message="krvaceni true"/>
      <SetResponseToHittingCCCPoint checkpointName="krvaceni true" response="expectedNext"/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = (player.soul:GetState("health")); if(a&lt;99) then DebugUtils.Log("krvaceni true") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>
      <!--LOCK FIRST AID SKILL AFTER BANDAGE USAGE-->
      <DoConsoleCommand command="wh_rpg_unlockAll 0"/>
    </FeatureTest>
    <!--BANDAGE TEST KONEC-->
    
  </Tests>

 
  <!--
Unwatched checkpoint 'TrackHurdle' has been hit.	
Unwatched checkpoint 'TrackTurnBegin' has been hit.	
Unwatched checkpoint 'TrackTurnEnd' has been hit.	
Unwatched checkpoint 'TrackPlatformJump' has been hit.	
Unwatched checkpoint 'TrackPlatformLeapStart' has been hit.	
Unwatched checkpoint 'TrackPlatformLeapEnd' has been hit.	
Unwatched checkpoint 'TrackChicaneStart' has been hit.	
Unwatched checkpoint 'TrackChicaneLeft' has been hit.	
Unwatched checkpoint 'TrackChicaneRight' has been hit.		
	-->
  
  <!--  Utilitky pro nastavovani reputace. Dulezita je hlavne repLoop ktera by mela nastavovar reputaci tak, aby feature testy nebyly zavisle na zmenach reputacniho systemu -->
  <Tests setName ="reputationUtils">
    <FeatureTest name="numberTest" enabled="1">
        <DoConsoleCommand command='#
                                  local testNum = 0;
                                  
                          '/>
      
      </FeatureTest>
    
    <!-- nastav reputaci pro obchodnika na 0.5. Resp snazime se nastavit nejblizsi mozne cislo po 0.5 nezavisle na tom, jak se bude hybat s crime systemem  -->
    <FeatureTest name="repLoop" enabled="1" description="Dummy loop na nastaveni reputace NPC" owners="LS">
      <!-- nejdrive vynulujeme obchodnikovu reputaci, at mame vychozi bod
           rep - ulozime hodnotu reputace do promene (jen prosta inicializace, asi by nakonec nebyla potreba)
           repInc - inicializace inkrementalni promenne (drzi hodnotu na kterou budeme postupne nastavovat reputaci na soule)
           
           potom ve smycce postupne nastavujeme reputaci na soule, dokud je celkova reputace mensi nez 0.5 (tahle hodnota bude treba hlidat dle aktualniho nastaveni crime systemu
           tzn maximalni hodnota reputace nastavitelna prez soulu nesmi byt mensi nez tato hodnota.) Dale by bylo vhodny, aby se jednalo o rozumne zaokrouhlene cislo
           V loopu bereme celkovou hodnotu reputace
      -->
      <DoConsoleCommand command='#                        
                        System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(0, 7, true)
                        local rep = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id))
                        local repInc = 0;
                        local secureCounter = 0
                        while rep &lt; 0.5 do
                          rep = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id))
                          secureCounter = secureCounter +1
                          if secureCounter &gt; 10000 then
                            break
                          end
                          if tostring(rep) == tostring(0.5) then
                             break
                          end
                          System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(repInc, 7, true)
                          repInc = repInc + 0.001
                          repInc = math.floor(repInc*10000)/10000

                        end '/>
      
      </FeatureTest>
    <!-- nastav reputaci pro obchodnika na 0.27. Resp snazime se nastavit nejblizsi mozne cislo po 0.27 nezavisle na tom, jak se bude hybat s crime systemem  -->
    <FeatureTest name="repLoop2" enabled="1" description="Dummy loop na nastaveni reputace NPC" owners="LS">
      <!-- nejdrive vynulujeme obchodnikovu reputaci, at mame vychozi bod
           rep - ulozime hodnotu reputace do promene (jen prosta inicializace, asi by nakonec nebyla potreba)
           repInc - inicializace inkrementalni promenne (drzi hodnotu na kterou budeme postupne nastavovat reputaci na soule)
           
           potom ve smycce postupne nastavujeme reputaci na soule, dokud je celkova reputace mensi nez 0.27 (tahle hodnota bude treba hlidat dle aktualniho nastaveni crime systemu
           tzn maximalni hodnota reputace nastavitelna prez soulu nesmi byt mensi nez tato hodnota.) Dale by bylo vhodny, aby se jednalo o rozumne zaokrouhlene cislo
           V loopu bereme celkovou hodnotu reputace
      -->
      <DoConsoleCommand command='#                        
                        System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(0, 7, true)
                        local rep = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id))
                        local repInc = 0;
                        local secureCounter = 0
                        while rep &lt; 0.27 do
                          rep = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id))
                          secureCounter = secureCounter +1
                          if secureCounter &gt; 100000 then
                            break
                          end
                          if tostring(rep) == tostring(0.27) then
                             break
                          end
                          System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(repInc, 7, true)
                          repInc = repInc + 0.001
                          repInc = math.floor(repInc*10000)/10000


                        end '/>

    </FeatureTest>
    <!-- nastav reputaci pro obchodnika na 0.027. Resp snazime se nastavit nejblizsi mozne cislo po 0.027 nezavisle na tom, jak se bude hybat s crime systemem  -->
    <FeatureTest name="repLoop3" enabled="1" description="Dummy loop na nastaveni reputace NPC" owners="LS">
      <!-- nejdrive vynulujeme obchodnikovu reputaci, at mame vychozi bod
           rep - ulozime hodnotu reputace do promene (jen prosta inicializace, asi by nakonec nebyla potreba)
           repInc - inicializace inkrementalni promenne (drzi hodnotu na kterou budeme postupne nastavovat reputaci na soule)
           
           potom ve smycce postupne nastavujeme reputaci na soule, dokud je celkova reputace mensi nez 0.027 (tahle hodnota bude treba hlidat dle aktualniho nastaveni crime systemu
           tzn maximalni hodnota reputace nastavitelna prez soulu nesmi byt mensi nez tato hodnota.) Dale by bylo vhodny, aby se jednalo o rozumne zaokrouhlene cislo
           V loopu bereme celkovou hodnotu reputace
      -->
      <DoConsoleCommand command='#                        
                        System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(0, 7, true)
                        local rep = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id))
                        local repInc = 0;
                        local secureCounter = 0
                        while rep &lt; 0.027 do
                          rep = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id))
                          secureCounter = secureCounter +1
                          if secureCounter &gt; 10000 then
                            break
                          end
                          if tostring(rep) == tostring(0.027) then
                             break
                          end
                          System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(repInc, 7, true)
                          repInc = repInc + 0.001
                          repInc = math.floor(repInc*10000)/10000

                        end '/>
      </FeatureTest>

  </Tests>  
  
  <!-- AUTOTESTO PRO OBCHODOVANI-->
  <!-- Nastaveni co ma a nema obchodnik u sebe se dela v databazi - tabulka: shop_type2item - v testlevelu pouzivam obchodnika: test_autotest_shop a shopID: 26 -->
  <!-- Je strasne dulezity, aby se to odehravalo na g_language whs, kvuli poradi itemy v inventari, ktere je kdyztak nasledujici:
  Jeden a pul rucni mec 1x
  Testing arrow 50x
  Brown quilted jacket 1x
  Bodlak 20x
  Kostival 10x
  Mata 20x
  Vlci mak 7x
  -->

   
  <Tests setName='shopping'>
    <FeatureTest name='shoppingFirstSetup' enabled='1' description='Nastavime si penize a reputaci s obchodnikem' owners='Jarda'>
      <RegisterLogAsCCCPoint message="Reputace OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Penize OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Penize OK" response="expectedNext"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="g_language whs"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="wh_cheat_money 140"/>
      <WaitSingleFrame/>
      <!-- <DoConsoleCommand command='#System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(0.9, 7, true); '/> -->
      <RunFeatureTest testName="repLoop"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#b = player.soul:AddBuff("46683e3b-e261-412f-b402-99ee17dda62a"); '/>
      <WaitSingleFrame/> 
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 1400; mam: " .. a); if(a == 1400) then DebugUtils.Log("Penize OK") end;'/>
      <!--<DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace - ocekavam: 0.625; mam: " .. a); if(a == 0.625) then DebugUtils.Log("Reputace OK") end;'/> -->
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace - ocekavam: 0.49-0.51; mam: " .. a); if((a &gt; 0.49) and (a &lt; 0.51 )) then DebugUtils.Log("Reputace OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='5'/>      
    </FeatureTest>

    <FeatureTest name='firstTradeBasketCheck' enabled='1' description='Vyzkousim kosik - dam do nej veci, opustim shop a mel bych ho mit napodruhe prazdny' owners='Jarda' prerequisite='shoppingFirstSetup'>
      <!-- V tomhle kroku vlastne zjistuji, jestli mi nezustavaji nejake veci v kosiku u obchodnika. Pokud by tam zustalo neco do druheho pruchodu, tak bych to koupil a zjistilo by se to ubytkem penez-->
      <RegisterLogAsCCCPoint message="Penize porad OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Penize porad OK" response="expectedNext"/>
      <!--<DoConsoleCommand command="playerGoto 984.5, 1021.8, 0"/> puvodni pozice, muselo se to posunout kvuli programatorske zmene vzdalenosti na talk a pickpocketing-->
      <DoConsoleCommand command="playerGoto 984.24, 1022.28, 0"/>
      <WaitSingleFrame />
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="8"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_back"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 1400; mam: " .. a); if(a == 1400) then DebugUtils.Log("Penize porad OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='40'/>
    </FeatureTest>

    <FeatureTest name='firstTradeBasketCheck2' enabled='1' description='Vyzkousim kosik 2 - dam do nej veci, opustim shop a mel bych ho mit napodruhe prazdny' owners='Jarda' prerequisite='firstTradeBasketCheck'>
      <Wait duration="5"/>
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="8"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_back"/>
      <WaitSingleFrame />
      <!--
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />-->
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 1400; mam: " .. a); if(a == 1400) then DebugUtils.Log("Penize porad OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='40'/>
    </FeatureTest>

    <FeatureTest name='merchantReputationSetup' description='nastavim opet reputaci obchodnika na plno' enabled='1' owners='Jarda' prerequisite='firstTradeBasketCheck2'>
      <RegisterLogAsCCCPoint message="Reputace 2 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace 2 OK" response="expectedNext"/>
      <WaitSingleFrame/>
      <!--<DoConsoleCommand command='#System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(1, 7, true); '/>-->
      <RunFeatureTest testName="repLoop"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace 2 - ocekavam: 0.49-0.51; mam: " .. a); if((a &gt; 0.49) and (a &lt; 0.51 )) then DebugUtils.Log("Reputace 2 OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>      
    </FeatureTest>

    <FeatureTest name='leaveHaggleESC' description='opustim smlouvani a snizim si tak reputaci' enabled='1' owners='Jarda' prerequisite='merchantReputationSetup'>
      <!--Opustim smlouvani pomoci podrzeni ESC a snizi mi to reputaci s obchodnikem-->
      <RegisterLogAsCCCPoint message="Reputace snizena OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace snizena OK" response="expectedNext"/>
      <WaitSingleFrame />
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>

      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>

      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />      
      <Wait duration="8"/>

      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <Wait duration="2"/>
      
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!-- 20170114 zmena ui_reset na ui_accept. ui_reset uz nespoustelo haggle, vypadato ze to bylo predelano na ui_accept -->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_accept"/>
      <Wait duration="5"/>
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      
      <Wait duration="14"/>
      <!-- ukonceni haggle/smlouvani se dela ui_skipDialog-->
      <!--20170118 tak ukonceni haggle/smlouvani od ted reaguje na ui_back a ne na ui_skipDialog-->
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_back"/>
      <Wait duration="3"/>
      <OverrideButtonInput_Release inputName="ui_back"/>
      <Wait duration="2"/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace snizena - ocekavam: 0.47-0.51; mam: " .. tostring(a)); if((a &gt; 0.47) and (a &lt; 0.51 )) then DebugUtils.Log("Reputace snizena OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='47'/>
    </FeatureTest>

    <FeatureTest name='merchantReputationSetup2' description='nastavim opet reputaci obchodnika na plno + hracovo penize na malo' enabled='1' owners='Jarda' prerequisite='leaveHaggleESC'>
      <RegisterLogAsCCCPoint message="Reputace 3 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace 3 OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Penize 3 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Penize 3 OK" response="expectedNext"/>
      <WaitSingleFrame/>
      <!-- <DoConsoleCommand command='#System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(0.05, 7, true); '/>   -->
      <RunFeatureTest testName="repLoop3"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <WaitSingleFrame/>
      <!--20161212 snizeni poctu penez, aby me obchodnik vyrazil z hagglu po prvnim neuspesnem pokusu-->
      <DoConsoleCommand command="wh_cheat_money 1"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace 3 - ocekavam: 0.027 - 0.028; mam: " .. a); if((a &gt; 0.027) and (a &lt; 0.028 )) then DebugUtils.Log("Reputace 3 OK") end;'/>
      <WaitSingleFrame />
      <!--20161212 snizeni poctu penez, aby me obchodnik vyrazil z hagglu po prvnim neuspesnem pokusu-->
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 100; mam: " .. a); if(a == 10) then DebugUtils.Log("Penize 3 OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>
    </FeatureTest>
  


    <FeatureTest name='haggleUnsuccessIn1Step' description='okamzite failnu smlouvani' enabled='1' owners='Jarda' prerequisite='merchantReputationSetup2'>
      <!--Nabidnu pri smlouvani tak nesmyslne malou castku, ze to obchodnika hned nastve-->
      <RegisterLogAsCCCPoint message="Reputace snizena 2 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace snizena 2 OK" response="expectedNext"/>
      <WaitSingleFrame />
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="8"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!-- 20170114 zmena ui_reset na ui_accept. ui_reset uz nespoustelo haggle, vypadato ze to bylo predelano na ui_accept -->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_accept"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="14"/>
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />      
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="12"/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace snizena - ocekavam: 0 - 0.012; mam: " .. a); if((a &gt;= 0) and (a &lt; 0.012 )) then DebugUtils.Log("Reputace snizena 2 OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='60'/>
    </FeatureTest>

    <FeatureTest name='merchantReputationSetup3' description='nastavim opet reputaci obchodnika na plno + hracovo penize na malo' enabled='1' owners='Jarda' prerequisite='haggleUnsuccessIn1Step'>
      <RegisterLogAsCCCPoint message="Reputace 4 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace 4 OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Penize 4 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Penize 4 OK" response="expectedNext"/>
      <WaitSingleFrame/>
      <!--<DoConsoleCommand command='#System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(0.5, 7, true); '/> -->
      <RunFeatureTest testName="repLoop2"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="wh_cheat_money 50"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace 4 - ocekavam: 0.27 - 0.28; mam: " .. a); if((a &gt; 0.27) and (a &lt; 0.28 )) then DebugUtils.Log("Reputace 4 OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 50; mam: " .. a); if(a == 500) then DebugUtils.Log("Penize 4 OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='4'/>
    </FeatureTest>

    <FeatureTest name='haggle2StepAngry1of2' description='behem smlouvani 2x nastvu obchodnika, nez me vyhodi - 1 cast' enabled='1' owners='Jarda' prerequisite='merchantReputationSetup3'>
      <!--Nabidnu pri smlouvani nizkou castku, obchodnik se nastve, ale neukonci smlouvani, v tu chvili overim jakou mame mezi sebou reputaci, nemela by se hnout... pokud by se hnula, znamenalo
      by to, ze me vyhodil a test failne. Ma me pustit k druhemu kroku, kde mu opet nabidnu nizkou castku a to uz se nastve a vyhodi me-->
      <RegisterLogAsCCCPoint message="Reputace zatim nesnizena OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace zatim nesnizena OK" response="expectedNext"/>
      <WaitSingleFrame />
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="4"/>
      <Wait duration="4"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="7"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!-- 20170114 zmena ui_reset na ui_accept. ui_reset uz nespoustelo haggle, vypadato ze to bylo predelano na ui_accept -->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_accept"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="11"/>
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="13"/>

      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace zatim nesnizena OK - ocekavam: 0.27 - 0.28; mam: " .. a); if((a &gt; 0.27) and (a &lt; 0.28 )) then DebugUtils.Log("Reputace zatim nesnizena OK") end;'/>

      <WaitUntilHitAllExpectedCCCPoints timeout='60'/>
    </FeatureTest>
    
    <FeatureTest name='haggle2StepAngry2of2' description='behem smlouvani 2x nastvu obchodnika, nez me vyhodi - 2 cast' enabled='1' owners='Jarda' prerequisite='haggle2StepAngry1of2'>
      <RegisterLogAsCCCPoint message="Reputace snizena 3 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace snizena 3 OK" response="expectedNext"/>
      <!--Cena by mela zustat na posledni nabidce, kterou jsem udelal, takze uplne dole-->
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="10"/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace snizena - ocekavam: 0.25 - 0.28; mam: " .. a); if((a &gt; 0.25) and (a &lt; 0.28 )) then DebugUtils.Log("Reputace snizena 3 OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='25'/>
    </FeatureTest>


    <FeatureTest name='merchantReputationSetup4' description='nastavim reputaci obchodnika na plno' enabled='1' owners='Jarda' prerequisite='haggle2StepAngry2of2'>
      <RegisterLogAsCCCPoint message="Reputace 5 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace 5 OK" response="expectedNext"/>
      <WaitSingleFrame/>
      <!--<DoConsoleCommand command='#System.GetEntityByName("test_merchant").soul:SetPlayerReputationDebug(1, 7, true); '/> -->
      <RunFeatureTest testName="repLoop"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace 5 - ocekavam: 0.49-0.51; mam: " .. a); if((a &gt; 0.49) and (a &lt; 0.51 )) then DebugUtils.Log("Reputace 5 OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='3'/>
    </FeatureTest>
    
    <FeatureTest name='shoppingPlayerNotEnoughMoney' enabled='1' description='Zkousim koupit, kdyz nemam dost penez' owners='Jarda' prerequisite='merchantReputationSetup4'>
      <!-- V tomhle kroku vlastne zjistuji, jestli mi nezustavaji nejake veci v kosiku u obchodnika. Pokud by tam zustalo neco do druheho pruchodu, tak bych to koupil a zjistilo by se to ubytkem penez-->
      <RegisterLogAsCCCPoint message="Hrac nemam mec OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac nemam mec OK" response="expectedNext"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <WaitSingleFrame/>
      <!--Najizdi do obchodu - start-->
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="7"/>
      <!--Najizdi do obchodu - konec-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <!--Uzavreni obchodu normalne bez smlouvani-->
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!--Pokud by to proslo, tak bych mel u sebe v tuhle chvili mec-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_back"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("802b5d64-5887-4964-93f0-5a7cf27d1115"); DebugUtils.Log("Ocekavam mec - 0; mam: " .. a); if(a == 0) then DebugUtils.Log("Hrac nemam mec OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='30'/>
    </FeatureTest>

    <FeatureTest name='shoppingMerchantNotEnoughMoney' enabled='1' description='Zkousim koupit, kdyz nemam dost penez' owners='Jarda' prerequisite='shoppingPlayerNotEnoughMoney'>
      <!-- V tomhle kroku vlastne zjistuji, jestli mi nezustavaji nejake veci v kosiku u obchodnika. Pokud by tam zustalo neco do druheho pruchodu, tak bych to koupil a zjistilo by se to ubytkem penez-->
      <RegisterLogAsCCCPoint message="Mec 1"/>
      <SetResponseToHittingCCCPoint checkpointName="Mec 1" response="expectedNext"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="wh_cheat_addItem 802b5d64-5887-4964-93f0-5a7cf27d1115"/>
      <WaitSingleFrame/>
      <!--Najizdi do obchodu - start-->
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="7"/>
      <!--Skok do SELL tabu-->
      <OverrideButtonInput_Press inputName="ui_controller_shoulder_r1"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_controller_shoulder_r1"/>
      <WaitSingleFrame />
      <!--Prodavam mec-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <!--Uzavreni obchodu normalne bez smlouvani-->
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!--Pokud by to proslo, tak by mel obchodnik v tuhle chvili 2. mec-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_back"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_back"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <DoConsoleCommand command="#Variables.SetGlobal('obchodnikMec',1)"/>
      <WaitUntilHitAllExpectedCCCPoints timeout='30'/>
    </FeatureTest>
    
    <FeatureTest name='shoppingBuyingFromMerchant' description='koupim od obchodnika neco a jemu se zvysi pocet penez a me se snizi' enabled='1' owners='Jarda' prerequisite='shoppingMerchantNotEnoughMoney'>
      <!--Nastaveni co ma a nema obchodnik u sebe se dela v databazi - tabulka: shop_type2item - v testlevelu pouzivam obchodnika: test_autotest_shop a shopID: 26 -->
      <!--Zjistovani, kolik ma obchodnik penez delam pres krabicky, od Michala B. jsem mel info, ze by melo fungovat: #Dump(Shops.GetShopMoney(System.GetEntityByName('Shop2').id)) ale vraci 0 a ma 5
      Proto na kazde zavolani commandu s nastavenim global promenne #Variables.SetGlobal('obchodnikPenez',1) zjistim v logu: "Penez X" kolik ma -->
      <RegisterLogAsCCCPoint message="Penez 5"/>
      <SetResponseToHittingCCCPoint checkpointName="Penez 5" response="expectedNext"/>
      <!--20161213 upravena castka z 9.5 na 7.5-->
      <!--20170222 upravena castka z 7.5 na 8.5-->
      <RegisterLogAsCCCPoint message="Penez 8.5"/>
      <SetResponseToHittingCCCPoint checkpointName="Penez 8.5" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Sipy 40"/>
      <SetResponseToHittingCCCPoint checkpointName="Sipy 40" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Mata 10"/>
      <SetResponseToHittingCCCPoint checkpointName="Mata 10" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Kostival 5"/>
      <SetResponseToHittingCCCPoint checkpointName="Kostival 5" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac penez zacatek OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac penez zacatek OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac penez po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac penez po obchodu OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac sipy po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac sipy po obchodu OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac mata po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac mata po obchodu OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac kostival po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac kostival po obchodu OK" response="expectedNext"/>
      <DoConsoleCommand command="#player.inventory:RemoveAllItems()"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="#Variables.SetGlobal('obchodnikPenez',1)"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="wh_cheat_money 100"/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 1000; mam: " .. a); if(a == 1000) then DebugUtils.Log("Hrac penez zacatek OK") end;'/>
      <!--Najizdi do obchodu - start-->
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="7"/>
      <!--Najizdi do obchodu - konec-->
      <!--Nakup sipu 10x-->
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />s
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Nakup 5x kostival-->
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Nakup 10x mata-->
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <!--Uzavreni obchodu normalne bez smlouvani-->
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!-- 20170114 zmena ui_reset na ui_accept - potvrzovani obchodu nefungovalo na ui_reset-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <!--Otestovani penez. Obchodnik si polepsil a ja pohorsil-->
      <DoConsoleCommand command="#Variables.SetGlobal('obchodnikPenez',1)"/>
      <WaitSingleFrame />
      <!--20161209 upravena castka z 955 na 975. Castka je ovlivnovana reputaci obchodnika vuci hraci-->
      <!--20170222 upravena castka z 975 na 965. Castka je ovlivnovana reputaci obchodnika vuci hraci-->
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 965; mam: " .. a); if(a == 965) then DebugUtils.Log("Hrac penez po obchodu OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("ad6f0f01-aec4-44d1-982c-1210eb01b74a"); DebugUtils.Log("Sipy - 10; mam: " .. a); if(a == 10) then DebugUtils.Log("Hrac sipy po obchodu OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("7da04bba-0564-42da-bcf1-9a2fc5faf025"); DebugUtils.Log("Mata - 10; mam: " .. a); if(a == 10) then DebugUtils.Log("Hrac mata po obchodu OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("de134f81-cfbe-422d-9105-df3e0b3b59b5"); DebugUtils.Log("Kostival - 5; mam: " .. a); if(a == 5) then DebugUtils.Log("Hrac kostival po obchodu OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='30'/>
    </FeatureTest>
    
    <FeatureTest name='shoppingSellingToMerchant' description='prodam obchodnikovi neco a jemu se snizi pocet penez a me se zvysi' enabled='1' owners='Jarda' prerequisite='shoppingBuyingFromMerchant'>
      <!--Nastaveni co ma a nema obchodnik u sebe se dela v databazi - tabulka: shop_type2item - v testlevelu pouzivam obchodnika: test_autotest_shop a shopID: 26 -->
      <!--Zjistovani, kolik ma obchodnik penez delam pres krabicky, od Michala B. jsem mel info, ze by melo fungovat: #Dump(Shops.GetShopMoney(System.GetEntityByName('Shop2').id)) ale vraci 0 a ma 5
      Uz funguje #Dump(Shops.GetShopMoney(System.GetEntityByName('merchant').id)) -> musi tam byt obchodnik a ne obchod
      Proto na kazde zavolani commandu s nastavenim global promenne #Variables.SetGlobal('obchodnikPenez',1) zjistim v logu: "Penez X" kolik ma -->
      <!--20161213 uprava penez, ktere ma obchodnik u sebe-->
      <!--20170222 uprava penez, ktere ma obchodnik u sebe z 7.5 na 7.0-->
      <RegisterLogAsCCCPoint message="Penez 7"/>
      <SetResponseToHittingCCCPoint checkpointName="Penez 7" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Sipy 40"/>
      <SetResponseToHittingCCCPoint checkpointName="Sipy 40" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Sipy 45"/>
      <SetResponseToHittingCCCPoint checkpointName="Sipy 45" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Mata 15"/>
      <SetResponseToHittingCCCPoint checkpointName="Mata 15" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Kostival 10"/>
      <SetResponseToHittingCCCPoint checkpointName="Kostival 10" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac penez zacatek OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac penez zacatek OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac penez po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac penez po obchodu OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac mata po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac mata po obchodu OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac kostival po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac kostival po obchodu OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac sipy po obchodu OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac sipy po obchodu OK" response="expectedNext"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command="#Variables.SetGlobal('obchodnikPenez',1)"/>
      <!--Ted by mel mit obchodnik 9.5 z predchoziho obchodovani-->
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 965; mam: " .. a); if(a == 965) then DebugUtils.Log("Hrac penez zacatek OK") end;'/>
      <!--Najizdi do obchodu - start-->
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="7"/>
      <!--Najizdi do obchodu - konec-->
      <!--SELL-->
      <OverrideButtonInput_Press inputName="ui_controller_shoulder_r1"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_controller_shoulder_r1"/>
      <WaitSingleFrame />
      <!--Prodat 5x kostival-->
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Prodat 5x mata-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Prodat 5x sip-->
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Uzavreni obchodu normalne bez smlouvani-->
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!-- 20170114 zmena ui_reset na ui_accept - potvrzovani obchodu nefungovalo na ui_reset-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="2"/>
      <!--Otestovani penez. Obchodnik si polepsil a ja pohorsil-->
      <DoConsoleCommand command="#Variables.SetGlobal('obchodnikPenez',1)"/>
      <WaitSingleFrame />
      <!--20161213 uprava castky, ktera Henrymu zbyde-->
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 980; mam: " .. a); if(a == 980) then DebugUtils.Log("Hrac penez po obchodu OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("7da04bba-0564-42da-bcf1-9a2fc5faf025"); DebugUtils.Log("Mata - 5; mam: " .. a); if(a == 5) then DebugUtils.Log("Hrac mata po obchodu OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("de134f81-cfbe-422d-9105-df3e0b3b59b5"); DebugUtils.Log("Kostival - 0; mam: " .. a); if(a == 0) then DebugUtils.Log("Hrac kostival po obchodu OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("ad6f0f01-aec4-44d1-982c-1210eb01b74a"); DebugUtils.Log("Sipy - 5; mam: " .. a); if(a == 5) then DebugUtils.Log("Hrac sipy po obchodu OK") end;'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='40'/>
    </FeatureTest>

    <FeatureTest name='shoppingBuySellHaggleInOneStep1of2' description='Neco nakoupim a zaroven prodam a usmlouvam si lepsi cenu' enabled='1' owners='Jarda' prerequisite='shoppingSellingToMerchant'>
      <RegisterLogAsCCCPoint message="Reputace smlouvani krok 1 OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace smlouvani krok 1 OK" response="expectedNext"/>
      <!--Najizdi do obchodu - start-->
      <SetLocalPlayerLookAtEntity entityName="TagPointMerchant" bone="Hips" duration="5"/>
      <Wait duration="5"/>
      <OverrideButtonInput_Press inputName="use"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="use"/>
      <WaitSingleFrame />
      <Wait duration="3"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="7"/>
      <!--Najizdi do obchodu - konec-->
      <!--Nakup 6x sip-->
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Nakup 7x kostival-->
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Nakup 9x mata-->
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--Skok do SELL tabu-->
      <OverrideButtonInput_Press inputName="ui_controller_shoulder_r1"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_controller_shoulder_r1"/>
      <WaitSingleFrame />
      <!--Prodej 5x mata-->
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_right"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_right"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!--A jdeme smlouvat-->
      <OverrideButtonInput_Press inputName="ui_reset"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_reset"/>
      <WaitSingleFrame />
      <Wait duration="1"/>
      <!-- 20170114 zmena ui_reset na ui_accept - smlouvani nefungovalo na ui_reset-->
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Hold inputName="ui_accept"/>
      <Wait duration="2"/>
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <!--Puvodni cena 3 davam na 1.3-->
      <Wait duration="12"/>
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_down"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_down"/>
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="15"/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace - ocekavam: 0.48-0.51; mam: " .. a); if((a &gt; 0.48) and (a &lt; 0.51 )) then DebugUtils.Log("Reputace smlouvani krok 1 OK") end;'/>
      <WaitSingleFrame />
      <WaitUntilHitAllExpectedCCCPoints timeout='59'/>

    </FeatureTest>

    <FeatureTest name='shoppingBuySellHaggleInOneStep2of2' description='Neco nakoupim a zaroven prodam a usmlouvam si lepsi cenu' enabled='1' owners='Jarda' prerequisite='shoppingBuySellHaggleInOneStep1of2'>
      <RegisterLogAsCCCPoint message="Reputace po smlouvani OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Reputace po smlouvani OK" response="expectedNext"/>
      <!--20161213 uprava castky, ktera obchodnikovi zustane po smlouvani-->
      <RegisterLogAsCCCPoint message="Penez 9.2"/>
      <SetResponseToHittingCCCPoint checkpointName="Penez 9.2" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Sipy 39"/>
      <SetResponseToHittingCCCPoint checkpointName="Sipy 39" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Mata 11"/>
      <SetResponseToHittingCCCPoint checkpointName="Mata 11" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Kostival 3"/>
      <SetResponseToHittingCCCPoint checkpointName="Kostival 3" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac penez po smlouvani OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac penez po smlouvani OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac mata po smlouvani OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac mata po smlouvani OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac kostival po smlouvani OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac kostival po smlouvani OK" response="expectedNext"/>
      <RegisterLogAsCCCPoint message="Hrac sipy po smlouvani OK"/>
      <SetResponseToHittingCCCPoint checkpointName="Hrac sipy po smlouvani OK" response="expectedNext"/>
      <!--Smlouvam na lepsi cenu-->
      <!--Pristupuji na cenu 2.5 - usetril jsem 0.4 weeej-->
      <Wait duration="1"/>
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_up"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Press inputName="ui_accept"/>
      <WaitSingleFrame />
      <OverrideButtonInput_Release inputName="ui_accept"/>
      <WaitSingleFrame />
      <Wait duration="10"/>
      <!--Zkontrolovani, ze doslo k vymene zbozi a penez a obchdnik se nenastval-->
      <DoConsoleCommand command='#a = (System.GetEntityByName("test_merchant").soul:GetRelationship(player.this.id)); DebugUtils.Log("Reputace - ocekavam: 0.48-0.51; mam: " .. a); if((a &gt; 0.48) and (a &lt; 0.51 )) then DebugUtils.Log("Reputace po smlouvani OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command="#Variables.SetGlobal('obchodnikPenez',1)"/>
      <WaitSingleFrame />
      <!--20161213 - uprava castky, ktera Henrymu zustane po smlouvani-->
      <DoConsoleCommand command='#DebugUtils.Log("shoppingBuySellHaggleInOneStep2of2")'/>
      <WaitSingleFrame/>
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("5ef63059-322e-4e1b-abe8-926e100c770e"); DebugUtils.Log("Penize - 958; mam: " .. a); if(a == 958) then DebugUtils.Log("Hrac penez po smlouvani OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("7da04bba-0564-42da-bcf1-9a2fc5faf025"); DebugUtils.Log("Mata - 9; mam: " .. a); if(a == 9) then DebugUtils.Log("Hrac mata po smlouvani OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("de134f81-cfbe-422d-9105-df3e0b3b59b5"); DebugUtils.Log("Kostival - 7; mam: " .. a); if(a == 7) then DebugUtils.Log("Hrac kostival po smlouvani OK") end;'/>
      <WaitSingleFrame />
      <DoConsoleCommand command='#a = player.inventory:GetCountOfClass("ad6f0f01-aec4-44d1-982c-1210eb01b74a"); DebugUtils.Log("Sipy - 11; mam: " .. a); if(a == 11) then DebugUtils.Log("Hrac sipy po smlouvani OK") end;'/>
      
      <WaitUntilHitAllExpectedCCCPoints timeout='50'/>

      <WaitSingleFrame/>
      
    </FeatureTest>

  </Tests>
  <!--KONEC AUTOTESTU PRO OBCHODOVANI-->
  
  <Tests setName='archeryNPC'>
    <FeatureTest name='hit1' enabled='1' description='NPC vystreli 1.sip do terce' owners='Jarda'>
      <SetResponseToHittingCCCPoint checkpointName='targetHitNPC_OK' response='expectedNext'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='20'/>
    </FeatureTest>
    
    <FeatureTest name='hit2' enabled='1' description='NPC vystreli 2.sip do terce' owners='Jarda'>
      <SetResponseToHittingCCCPoint checkpointName='targetHitNPC_OK' response='expectedNext'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='10'/>
    </FeatureTest>
    <FeatureTest name='arrowFallOnGround' enabled='1' description='NPC vystreli 3.sip, tentokrat na zem' owners='Jarda'>
      <SetResponseToHittingCCCPoint checkpointName='arrowFall_OK' response='expectedNext'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='10'/>
    </FeatureTest>
    
    <FeatureTest name='lastArrowInInventory' enabled='1' description='NPC zkontroluje, ze ma 1 sip v inventari' owners='Jarda'>
      <SetResponseToHittingCCCPoint checkpointName='arrowInInventoryNPC_1_OK' response='expectedNext'/>
      <WaitUntilHitAllExpectedCCCPoints timeout='1'/>
    </FeatureTest>
  </Tests>

	<Tests setName="Finish">
		<FeatureTest name="ResetTheKeyboard" description="Deinitializes some cvars and toggles - makes sense in the editor" enabled="true" owners="tomas.grunwald">
			<DoConsoleCommand command="#ActionMapManager.EnableActionMap('player', true);" />
		</FeatureTest>
	</Tests>

	<Tests setName="Dummy">
		<FeatureTest name="dummyTest" description="for testing purposes" enabled="true" owners="tomas.grunwald">
			<DoConsoleCommand command="#ActionMapManager.EnableActionMap('player', false);" />
			<!--beam player after the trigger-->
			<!--
			<DoConsoleCommand command="playerGoto 1056, 1006, 0"/>
			<MovePlayerToOtherEntity className="NPC" who="localPlayer"/>
			-->
			<DoConsoleCommand command="playerGoto 1056, 1006, 0"/>
			<MovePlayerToOtherEntity className="NPC" who="localPlayer"/>

			<RunFlowGraphFeatureTests quickload="false" reloadLevel="false" timeout="1" waitScheduled="1" />
			
			<!--
			<Wait duration="1.0" />
			-->
			<!--turn around using lookat-->
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<RunFeatureTest testName="UtilFollow"/>
			<!--goto trigger-->
			<Wait duration="3.0" />
			<DoConsoleCommand command="#ActionMapManager.EnableActionMap('player', true);" />
		</FeatureTest>
	</Tests>
</FeatureTester>